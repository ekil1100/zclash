# Benchmark Scenarios（Phase 0）

> 状态：DOING  
> 更新时间：2026-02-11 03:17 (GMT+8)

## 1. 目标
建立可重复、可回归、可横向对比（mihomo/clash vs zclash）的标准测试场景。

## 2. 场景分层

### S1. 启动与基础可用
- 输入：最小配置（1 个 proxy + 1 个 proxy-group）
- 验证：
  - 启动成功
  - 本地端口可连通
  - 首次请求可通过
- 输出指标：启动耗时、首次可用时间

### S2. 规则匹配正确性
- 输入：domain / domain-suffix / domain-keyword / ip-cidr / geo 规则组合
- 验证：
  - 路由命中符合预期
  - 冲突规则优先级正确
- 输出指标：规则命中率、错误路由率

### S3. 代理组切换与生效时延
- 输入：同一组内多个节点（快/慢/故障）
- 验证：
  - 手动切换生效
  - 自动策略切换行为正确
- 输出指标：切换生效时延、切换失败率

### S4. DNS 场景
- 输入：正常 DNS / 高延迟 DNS / 间歇失败 DNS
- 验证：
  - 回退策略有效
  - 缓存命中和过期行为正确
- 输出指标：解析时延、失败率、缓存命中率

### S5. 并发吞吐与资源占用
- 输入：低并发（100）/中并发（1k）/高并发（5k）
- 验证：
  - 请求成功率
  - 无异常崩溃
- 输出指标：吞吐、p95 延迟、CPU、内存峰值

### S6. 长稳与故障恢复
- 输入：24h 连续流量 + 注入节点故障/网络抖动
- 验证：
  - 服务持续可用
  - 自动恢复/手动恢复路径可用
- 输出指标：崩溃次数、恢复时长、错误率漂移

## 3. 建议目录

- `testdata/config/minimal.yaml`
- `testdata/config/multi-proxy.yaml`
- `testdata/rules/rule-matrix.yaml`
- `testdata/scripts/`（后续基准脚本）

## 4. 先行落地顺序

1. S1 + S2（正确性）
2. S3 + S4（行为一致性）
3. S5 + S6（性能与稳定性）
