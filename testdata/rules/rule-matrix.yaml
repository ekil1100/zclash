rules:
  - DOMAIN,example.com,PROXY
  - DOMAIN-SUFFIX,google.com,PROXY
  - DOMAIN-KEYWORD,github,PROXY
  - IP-CIDR,8.8.8.0/24,PROXY
  - GEOIP,CN,DIRECT
  - MATCH,PROXY

cases:
  - id: domain_exact
    input:
      host: example.com
    expect:
      target: PROXY
      matched_rule: DOMAIN,example.com

  - id: domain_suffix
    input:
      host: www.google.com
    expect:
      target: PROXY
      matched_rule: DOMAIN-SUFFIX,google.com

  - id: domain_keyword
    input:
      host: raw.githubusercontent.com
    expect:
      target: PROXY
      matched_rule: DOMAIN-KEYWORD,github

  - id: ip_cidr
    input:
      ip: 8.8.8.8
    expect:
      target: PROXY
      matched_rule: IP-CIDR,8.8.8.0/24

  - id: geoip_cn
    input:
      ip: 114.114.114.114
    expect:
      target: DIRECT
      matched_rule: GEOIP,CN

  - id: fallback_match
    input:
      host: unknown.test
    expect:
      target: PROXY
      matched_rule: MATCH
